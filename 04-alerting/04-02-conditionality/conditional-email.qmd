---
title: A slightly more complex email from Quarto
format: email
editor: visual
---

This is a slightly more complex report using Quarto. This time, add the following to the email structure below:

-   A `{.email-scheduled}` div containing a code chunk that, when evaluated as something "truthy", will send an email; when evaluated as something "falsy", will suppress the email

-   A `{.content-visible when-meta="verbose"}` div that will add additional data to your email when a metadata parameter named "verbose" is "true"

Helper:

The R package `{quarto}` includes a number of Quarto CLI wrappers and helpers, including a function `write_yaml_metadata_block` which will allow dynamic creation of metadata that is read at document render.

**Importantly, in the code block, you must include `#| output: asis` for correct rendering.**

Let's write our metadata.

```{r}
#| output: asis

quarto::write_yaml_metadata_block(
    verbose = "TRUE"
)

```

Which will include a YAML metadata field of `verbose: true` in our Quarto document. This can now be used for our conditionality.

:::: email
::: subject
Hello from Quarto, conditionally
:::

This is the main body of the email. But if we have the "verbose" metadata parameter set to `true`, then more detail will follow!
::::

````{=html}

<!-- Hint: 

:::::: {.email}
::: {.email-scheduled}
```{r}
TRUE
```

:::

::: {.subject}
Hello from Quarto, conditionally
:::

This is the main body of the email. But if we have the "verbose" metadata parameter set to `true`, then more detail will follow!

::: {.content-visible when-meta="verbose"}
Here is some interesting data:

```{r}
library(gt)

head(mtcars) |> gt()
```

:::
::::::

-->
````